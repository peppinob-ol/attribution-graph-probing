# Steerify

The Steerify app was 100% generated by a single prompt to Claude Code. The prompt used is pasted in the `Claude Code Prompt` section at the end.

A simple NextJS frontend for searching and steering language models using Neuronpedia features.

## Getting Started

1. Make sure the inference server is running:

   ```bash
   cd apps/inference && poetry install && poetry run python start.py
   ```

2. In another terminal, start the Steerify app:

   ```bash
   cd apps/experiments/steerify
   npm install
   npm run dev
   ```

3. Open your browser and navigate to:
   ```
   http://localhost:3000
   ```

## Features

- Search for Neuronpedia features by keyword
- Steer GPT-2 Small model using the top 5 search results
- Visualize the steered completions in a simple table interface
- Example queries for quick searches

## Implementation Details

- Built with NextJS App Router, Tailwind CSS, and Shadcn UI components
- Makes API calls to Neuronpedia for search and localhost:5002 for inference
- Simple and elegant interface for exploring model steering

## Claude Code Prompt

The following is the prompt used for Claude Code to generate this code:

```
Task: Build a new NextJS frontend for the inference server, called "steerify". This is a VERY SIMPLE app with only two API calls. Steerify searches for features using an API, then steers a model using the top 5 search results. It displays these results to the user in a simple but elegant interface.

Implementation:
- Put the new frontend under /apps/experiments/steerify. It should start on localhost on port 3000. Use Shadcn, Tailwind, fetch for API calls, and NextJS app directory.
- User Flow
	1) Ensure that the inference server is running at localhost:5002 by calling localhost:5002/health (no /v1/). If it's not running, show error and ask user to start the inference server with command: `cd apps/inference && poetry install && poetry run python start.py`
	2) SET PROMPT
		By default the STEER_PROMPT is "I often think about". Allow the user to modify this.
	3) SEARCH
		a) User inputs a SEARCH_QUERY to find features to steer (eg "dogs"). On the same screen, provide 3 example search queries that can be clicked instead: "dogs", "happiness", "star wars". The examples should appear above the user input.
		b) When user submits query, call the "Search by SAEs" Neuronpedia POST API:
			- base URL: https://www.neuronpedia.org/api/explanation/search
			- modelId: gpt2-small
			- layers: ["5-res-jb", "6-res-jb", "7-res-jb"]
			- query: (user's query here - eg "dogs")
		c) In the JSON response body, get the top 5 items of the `results` array, keeping the `modelId`, `layer`, `index`, and `description`, and `neuron`.`maxActApprox` fields of each dict in the array. `index` will return as a string, but you should force parse it to be a number. Each result is one RESPONSE_RESULT.
		d) Display results table: List each RESPONSE_RESULT in a table with the above fields as columns. Headers: `modelId` = Model, `layer` = Source, `index` = Index, `description` = Description, `neuron`.`maxActApprox` = Strength. Add a column called Steered Completion as the last column. Put PROMPT + loading spinner in the last column while it awaits results.
	4) STEER (repeat sequentially for each of the top 5 RESPONSE_RESULT)
		i) Call the inference server at localhost:5002/v1/steer/completion using RESPONSE_RESULTS. Check the steer example in the apps/inference/README.md, using this POST JSON body:
			prompt: STEER_PROMPT
			model: RESPONSE_RESULT.modelId
			features: [ { model: RESPONSE_RESULT.modelId, source: RESPONSE_RESULT.layer, index: RESPONSE_RESULT.index (force parse as a number), strength: RESPONSE_RESULT.neuron.maxActApprox (parse as a number) } ]
			types: ["STEERED"]
			n_completion_tokens: 16
			temperature: 0.5
			strength_multiplier: 1.5
			freq_penalty: 1
			seed: 16
			steer_method: "SIMPLE_ADDITIVE"
			normalize_steering: false
		ii) Parse response body JSON:
			Response format is under schemas/openapi/inference/steer/completion. Format is `outputs` with an array of dicts. Get the first array item and get its `output` text value. This is STEERED_COMPLETION - display it in the Steered Completion cell, replacing both the STEER_PROMPT and the loading spinner. You should show each of these results as they are returned, not all at once.
	5) When all 5 results are complete, show "Steerify Complete" below the table, and give the user a button "Reset" to clear the SEARCH_QUERY and results table to start over the user flow.

After you are done implementing, write a quick README.md under /apps/steerify for how to start it.
```
